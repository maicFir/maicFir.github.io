import{_ as t,o,c,a as s,d as e,e as a,b as n,r as l}from"./app.853ad0f9.js";const i={},u=a('<p><code>webpack</code>\u5982\u4F55\u6253\u5305\u8D44\u6E90\u4F18\u5316\u4F60\u6709\u4E86\u89E3\u5417\uFF1F\u6216\u8005\u4E00\u4E2A\u7ECF\u5E38\u88AB\u95EE\u7684\u9762\u8BD5\u9898\uFF0C\u9996\u5C4F\u52A0\u8F7D\u5982\u4F55\u4F18\u5316\uFF0C\u5176\u5B9E\u65E0\u975E\u5C31\u662F\u4ECE<code>http</code>\u8BF7\u6C42\u3001<code>\u6587\u4EF6\u8D44\u6E90</code>\u3001<code>\u56FE\u7247\u52A0\u8F7D</code>\u3001<code>\u8DEF\u7531\u61D2\u52A0\u8F7D</code>\u3001<code>\u9884\u8BF7\u6C42</code>\uFF0C<code>\u7F13\u5B58</code>\u8FD9\u4E9B\u65B9\u5411\u6765\u4F18\u5316\uFF0C\u901A\u5E38\u5728\u4F7F\u7528\u811A\u624B\u67B6\u4E2D\uFF0C\u6210\u719F\u7684\u811A\u624B\u67B6\u5DF2\u7ECF\u7ED9\u4F60\u505A\u4E86\u6700\u5927\u7684\u4F18\u5316\uFF0C\u6BD4\u5982\u538B\u7F29\u8D44\u6E90\uFF0C\u4EE3\u7801\u7684<code>tree shaking</code>\u7B49\u3002</p><p>\u672C\u6587\u662F\u7B14\u8005\u6839\u636E\u4EE5\u5F80\u7ECF\u9A8C\u4EE5\u53CA\u9605\u8BFB\u5B98\u65B9\u6587\u6863\u603B\u7ED3\u7684\u4E00\u7BC7\u5173\u4E8E<code>webpack\u6253\u5305</code>\u65B9\u9762\u7684\u957F\u6587\u7B14\u8BB0\uFF0C\u5E0C\u671B\u5728\u9879\u76EE\u4E2D\u6709\u6240\u5E2E\u52A9\u3002</p><p>\u6B63\u6587\u5F00\u59CB...</p><p>\u5728\u9605\u8BFB\u4E4B\u524D\uFF0C\u672C\u6587\u5C06\u4ECE\u4EE5\u4E0B\u51E0\u4E2A\u70B9\u53BB\u63A2\u8BA8 webpack \u7684\u6253\u5305\u4F18\u5316</p><p>1\u3001<code>webpack</code>\u5982\u4F55\u505A<code>treeShaking</code></p><p>2\u3001<code>webpack</code>\u7684 gizp \u538B\u7F29</p><p>3\u3001<code>css</code>\u5982\u4F55\u505A<code>treeShaking</code>,</p><p>4\u3001\u5165\u53E3\u4F9D\u8D56\u6587\u4EF6<code>\u62C6\u5305</code></p><p>5\u3001<code>\u56FE\u7247\u8D44\u6E90</code>\u52A0\u8F7D\u4F18\u5316</p><h3 id="treeshaking" tabindex="-1"><a class="header-anchor" href="#treeshaking" aria-hidden="true">#</a> treeShaking</h3>',10),r=n("\u5728\u5B98\u7F51\u4E2D\u6709\u63D0\u5230"),d={href:"https://webpack.docschina.org/guides/tree-shaking/",title:"treeShaking",target:"_blank",rel:"noopener noreferrer"},k=n("treeShaking"),v=n(",\u4ECE\u540D\u5B57\u4E0A\u4E2D\u6587\u89E3\u91CA\u5C31\u662F\u6447\u6811\uFF0C\u5C31\u662F\u5229\u7528"),m=s("code",null,"esModule",-1),b=n("\u7684\u7279\u6027\uFF0C\u5220\u9664\u4E0A\u4E0B\u6587\u672A\u5F15\u7528\u7684\u4EE3\u7801\u3002\u56E0\u4E3A webpack \u53EF\u4EE5\u6839\u636E"),g=s("code",null,"esModule",-1),h=n("\u505A\u9759\u6001\u5206\u6790\uFF0C\u672C\u8EAB\u6765\u8BF4\u5B83\u662F\u6253\u5305\u7F16\u8BD1\u524D\u8F93\u51FA\uFF0C\u6240\u4EE5"),y=s("code",null,"webpack",-1),f=n("\u5728\u7F16\u8BD1"),w=s("code",null,"esModule",-1),_=n("\u7684\u4EE3\u7801\u65F6\u5C31\u53EF\u4EE5\u505A\u4E0A\u4E0B\u6587\u672A\u5F15\u7528\u7684\u5220\u9664\u64CD\u4F5C\u3002"),x=a(`<p>\u90A3\u4E48\u5982\u4F55\u505A<code>treeshaking</code>?\u6211\u4EEC\u6765\u5206\u6790\u4E0B</p><h3 id="\u5FEB\u901F\u521D\u59CB\u5316\u4E00\u4E2A-webpack-\u9879\u76EE" tabindex="-1"><a class="header-anchor" href="#\u5FEB\u901F\u521D\u59CB\u5316\u4E00\u4E2A-webpack-\u9879\u76EE" aria-hidden="true">#</a> \u5FEB\u901F\u521D\u59CB\u5316\u4E00\u4E2A webpack \u9879\u76EE</h3><p>\u5728\u4E4B\u524D\u6211\u4EEC\u90FD\u662F\u624B\u52A8\u914D\u7F6E\u642D\u5EFA<code>webpack</code>\u9879\u76EE\uFF0C<code>webpack</code>\u5B98\u65B9\u63D0\u4F9B\u4E86<code>cli</code>\u5FEB\u901F\u6784\u5EFA\u57FA\u672C\u6A21\u7248\uFF0C\u65E0\u9700\u50CF\u4E4B\u524D\u4E00\u6837\u624B\u52A8\u914D\u7F6E<code>entry</code>\u3001<code>plugins</code>\u3001<code>loader</code>\u7B49</p><p>\u9996\u5148\u5B89\u88C5<code>npm i webpack webpack-cli</code>\uFF0C\u547D\u4EE4\u884C\u6267\u884C\`</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npx webpack init
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E00\u7CFB\u5217\u521D\u59CB\u5316\u64CD\u4F5C\u540E\uFF0C\u5C31\u751F\u6210\u4EE5\u4E0B\u4EE3\u7801\u4E86 <img src="https://files.mdnice.com/user/24614/d00ffdba-a94b-4d80-b378-550af52e1364.png" alt=""> \u9ED8\u8BA4\u7684<code>webpack.config.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Generated using webpack-cli https://github.com/webpack/webpack-cli</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mini-css-extract-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> WorkboxWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;workbox-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isProduction <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> stylesHandler <span class="token operator">=</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&#39;localhost&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;index.html&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Add your plugins here</span>
    <span class="token comment">// Learn more about plugins from https://webpack.js.org/configuration/plugins/</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(js|jsx)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.less$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>stylesHandler<span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postcss-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;less-loader&#39;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>stylesHandler<span class="token punctuation">,</span> <span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;postcss-loader&#39;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(eot|svg|ttf|woff|woff2|png|jpg|gif)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;asset&#39;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Add your rules for custom modules here</span>
      <span class="token comment">// Learn more about loaders from https://webpack.js.org/loaders/</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">;</span>

    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u547D\u4EE4<code>npm run serve</code><img src="https://files.mdnice.com/user/24614/3a94620d-4717-4460-a27c-8a6aed495be5.png" alt=""></p><p>\u73B0\u5728\u4FEE\u6539\u4E00\u4E0B<code>index.js</code>,\u5E76\u5728<code>src</code>\u4E2D\u589E\u52A0<code>utils</code>\u76EE\u5F55</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// utils/index.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>index.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728<code>index.js</code>\u4E2D\u6211\u53EA\u5F15\u5165\u4E86<code>add</code>\uFF0C\u76F8\u5F53\u4E8E<code>square</code>\u8FD9\u4E2A\u51FD\u6570\u5728\u4E0A\u4E0B\u6587\u4E2D\u5E76\u672A\u5F15\u7528\u3002</p><h3 id="usedexports" tabindex="-1"><a class="header-anchor" href="#usedexports" aria-hidden="true">#</a> usedExports</h3><p>\u4E0D\u8FC7\u6211\u8FD8\u9700\u8981\u6539\u4E0B<code>webpack.config.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">&#39;source-map&#39;</span>
    config<span class="token punctuation">.</span>optimization <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\u6211\u53EA\u589E\u52A0\u4E86<code>devtool:source-map</code>\u4E0E<code>optimization.usedExports = true</code></p><p>\u6211\u4EEC\u770B\u4E0B<code>package.json</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode=production --node-env=production&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build:dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode=development&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build:prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --mode=production --node-env=production&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack serve&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9ED8\u8BA4\u521D\u59CB\u5316\u5DF2\u7ECF\u7ED9\u4EEC\u9884\u8BBE\u4E86\u591A\u4E2A\u4E0D\u540C\u7684\u6253\u5305\u73AF\u5883\uFF0C\u56E0\u6B64\u6211\u53EA\u9700\u8981\u8FD0\u884C\u4E0B\u9762\u547D\u4EE4\u5C31\u53EF\u4EE5\u9009\u62E9\u5F00\u53D1\u73AF\u5883\u4E86</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm run build<span class="token operator">:</span>dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://files.mdnice.com/user/24614/dd5f1a51-432c-4101-b371-1b426dcd37e6.png" alt=""> \u6B64\u65F6\u6211\u4EEC\u770B\u5230\u6253\u5305\u540E\u7684\u4EE3\u7801\u672A\u5F15\u5165\u7684<code>square</code>\u6709\u4E00\u884C\u6CE8\u91CA</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* unused harmony export square */</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>square</code>\u4E0A\u4E0B\u6587\u672A\u5F15\u7528\uFF0C\u867D\u7136\u7ED9\u4E86\u6807\u8BB0\uFF0C\u4F46\u662F\u672A\u771F\u6B63\u6E05\u9664\u3002</p><p>\u5149\u4F7F\u7528<code>usedExports:true</code>\u8FD8\u4E0D\u884C\uFF0C<code>usedExports \u4F9D\u8D56\u4E8E terser \u53BB\u68C0\u6D4B\u8BED\u53E5\u4E2D\u7684\u526F\u4F5C\u7528</code>,\u56E0\u6B64\u9700\u8981\u501F\u52A9<code>terser</code>\u63D2\u4EF6\u4E00\u8D77\u4F7F\u7528\uFF0C\u5B98\u65B9<code>webpack5</code>\u63D0\u4F9B\u4E86<code>TerserWebpackPlugin</code>\u8FD9\u6837\u4E00\u4E2A\u63D2\u4EF6</p><p>\u5728<code>webpack.config.js</code>\u4E2D\u5F15\u5165</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;terser-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">&#39;source-map&#39;</span>
    config<span class="token punctuation">.</span>optimization <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u8BBE\u7F6E\u4E3Atrue \u544A\u8BC9webpack\u4F1A\u505Atreeshaking</span>
      <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5F00\u542Fterser</span>
      <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">extractComments</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// \u662F\u5426\u5C06\u6CE8\u91CA\u5265\u79BB\u5230\u5355\u72EC\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u662Ftrue</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F60\u4F1A\u53D1\u73B0\uFF0C\u90A3\u4E2A<code>square</code>\u51FD\u6570\u5C31\u6CA1\u6709\u4E86 <img src="https://files.mdnice.com/user/24614/9423307e-23d2-464b-b069-5adb708931b2.png" alt=""> \u5982\u679C\u6211\u5C06<code>usedExports.usedExports = false</code>,\u4F60\u4F1A\u53D1\u73B0<code>square</code>\u6CA1\u6709\u88AB\u5220\u9664\u3002 <img src="https://files.mdnice.com/user/24614/ae858b55-8062-4200-b319-4edd0090bdef.png" alt=""></p><p>\u5B98\u65B9\u89E3\u91CA\uFF0C\u5F53\u6211\u4EEC\u8BBE\u7F6E<code>optimization.usedExports</code>\u5FC5\u987B\u4E3A<code>true</code>,\u5F53\u6211\u4EEC\u8BBE\u7F6E<code>usedExports:true</code>\uFF0C\u4E14\u5FC5\u987B\u5F00\u8D77<code>minimize: true</code>\uFF0C\u8FD9\u6837\u624D\u4F1A\u628A\u4E0A\u4E0B\u6587\u672A\u4F7F\u7528\u7684\u4EE3\u7801\u7ED9\u6E05\u9664\u6389\uFF0C\u5982\u679C<code>minimize: false</code>,\u90A3\u4E48\u538B\u7F29\u63D2\u4EF6\u5C06\u4F1A\u5931\u6548\u3002</p><p>\u5F53\u6211\u4EEC\u8BBE\u7F6E<code>usedExports: true</code></p><p>\u6B64\u65F6\u751F\u6210\u6253\u5305\u7684\u4EE3\u7801\u4F1A\u6709\u4E00\u4E2A\u8FD9\u6837\u7684\u9B54\u6CD5\u6CE8\u91CA,<code>square</code>\u672A\u4F7F\u7528</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/* unused harmony export square */</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u6211\u4EEC\u8BBE\u7F6E<code>minimize: true</code>\u65F6\uFF0C<code>webpack5</code>\u4F1A\u9ED8\u8BA4\u5F00\u542F<code>terser</code>\u538B\u7F29\uFF0C\u7136\u540E\u53D1\u73B0\u6709\u8FD9\u6837\u7684<code>unused harmony export square</code>\u5C31\u4F1A\u5220\u6389\u5BF9\u5E94\u672A\u5F15\u5165\u7684\u4EE3\u7801\u3002</p><h3 id="sideeffects" tabindex="-1"><a class="header-anchor" href="#sideeffects" aria-hidden="true">#</a> sideEffects</h3><p>\u8FD9\u4E2A\u662F<code>usedExports</code>\u6447\u6811\u7684\u53E6\u4E00\u79CD\u65B9\u6848\uFF0C<code>usedExports</code>\u662F\u68C0\u67E5\u4E0A\u4E0B\u6587\u6709\u6CA1\u6709\u5F15\u7528\uFF0C\u5982\u679C\u6CA1\u6709\u5F15\u7528\uFF0C\u5C31\u4F1A\u6CE8\u5165<code>\u9B54\u6CD5\u6CE8\u91CA</code>\uFF0C\u901A\u8FC7<code>terser</code>\u538B\u7F29\u8FDB\u884C\u53BB\u9664\u672A\u5F15\u5165\u7684\u4EE3\u7801</p><p>\u800C<code>slideEffects</code>\u662F\u5BF9<code>\u6CA1\u6709\u526F\u4F5C\u7528</code>\u7684\u4EE3\u7801\u8FDB\u884C\u53BB\u9664</p><p>\u9996\u5148\u4EC0\u4E48\u662F<code>\u526F\u4F5C\u7528</code>\uFF0C\u8FD9\u662F\u4E00\u4E2A\u4E0D\u592A\u597D\u7406\u89E3\u7684\u8BCD\uFF0C\u5728<code>react</code>\u4E2D\u7ECF\u5E38\u6709\u542C\u5230</p><p>\u5176\u5B9E<code>\u526F\u4F5C\u7528</code>\u5C31\u662F\u4E00\u4E2A\u7EAF\u51FD\u6570\u4E2D\u5B58\u5728\u53EF\u53D8\u4F9D\u8D56\u7684\u56E0\u53D8\u91CF\uFF0C\u56E0\u4E3A\u67D0\u4E2A\u56E0\u53D8\u91CF\u4F1A\u9020\u6210\u7EAF\u51FD\u6570\u4EA7\u751F\u4E0D\u53EF\u63A7\u7684\u7ED3\u679C</p><p>\u4E3E\u4E2A\u4F8B\u5B50</p><p>\u6CA1\u6709\u526F\u4F5C\u7528\u7684\u51FD\u6570\uFF0C\u8F93\u5165\u8F93\u51FA\u5F88\u660E\u786E</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">watchEnv</span><span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> env <span class="token operator">===</span> <span class="token string">&#39;prd&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;product&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">watchEnv</span><span class="token punctuation">(</span><span class="token string">&#39;prd&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6709\u526F\u4F5C\u7528,\u51FD\u6570\u4F53\u5185\u6709\u4E0D\u786E\u5B9A\u6027\u56E0\u7D20</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">watchEnv</span><span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    env <span class="token operator">=</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> env <span class="token operator">===</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;\u751F\u4EA7\u73AF\u5883&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;\u6D4B\u8BD5\u5F00\u53D1\u73AF\u5883&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u5728<code>index.js</code>\u4E2D\u5F15\u5165<code>watch.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;./utils/watch.js&#39;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u8FD0\u884C<code>npm run build:dev</code>,\u6253\u5305\u540E\u7684\u6587\u4EF6\u6709<code>watch</code>\u7684\u5F15\u5165</p><p><img src="https://files.mdnice.com/user/24614/191110aa-26a5-49de-9bc3-60a63ecb49be.png" alt=""></p><p>\u5728<code>index.js</code>\u4E2D\u5F15\u5165<code>watch.js</code>\u5E76\u6CA1\u6709\u4EC0\u4E48\u4F7F\u7528,\u4F46\u662F\u6211\u4EEC\u4ECD\u7136\u6253\u5305\u4E86\u8FDB\u53BB</p>`,48),j=n("\u4E3A\u4E86\u53BB\u9664\u8FD9\u5F15\u5165\u4F46\u672A\u88AB\u4F7F\u7528\u7684\u4EE3\u7801\uFF0C\u56E0\u6B64\u4F60\u9700\u8981\u5728"),q=s("code",null,"optimization.sideEffects: true",-1),E=n("\uFF0C\u5E76\u4E14\u8981\u5728"),P=s("code",null,"package.json",-1),z=n("\u4E2D\u8BBE\u7F6E"),W=s("code",null,"sideEffects: false",-1),C=n("\uFF0C\u5728"),S=s("code",null,"optimization.sideEffects",-1),M=n("\u8BBE\u7F6E true,\u544A\u77E5 webpack \u6839\u636E package.json \u4E2D\u7684 sideEffects \u6807\u8BB0\u7684\u526F\u4F5C\u7528\u6216\u8005\u89C4\u5219\uFF0C\u4ECE\u800C\u544A\u77E5 webpack \u8DF3\u8FC7\u4E00\u4E9B\u5F15\u5165\u4F46\u672A\u88AB\u4F7F\u7528\u7684\u6A21\u5757\u4EE3\u7801\u3002\u5177\u4F53\u53C2\u8003"),H={href:"https://webpack.docschina.org/configuration/optimization/#optimizationsideeffects",title:"optimization.sideEffects",target:"_blank",rel:"noopener noreferrer"},T=n("optimization.sideEffects"),D=a(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">;</span>

    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>config<span class="token punctuation">.</span>optimization <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">sideEffects</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5F00\u542FsideEffects</span>
        <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5F00\u542Fterser</span>
        <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">extractComments</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// \u662F\u5426\u5C06\u6CE8\u91CA\u5265\u79BB\u5230\u5355\u72EC\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u662Ftrue</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my-webpack-project&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My webpack project&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u65F6\u4F60\u8FD0\u884C\u547D\u4EE4<code>npm run build:dev</code>\uFF0C\u67E5\u770B\u6253\u5305\u6587\u4EF6 <img src="https://files.mdnice.com/user/24614/3807f010-fcb6-471f-8333-bd5e3d6c1858.png" alt=""> \u6211\u4EEC\u5C31\u4F1A\u53D1\u73B0\uFF0C\u5F15\u5165\u7684<code>watch.js</code>\u5C31\u6CA1\u6709\u4E86</p><p>\u5728\u5B98\u65B9\u4E2D\u6709\u8FD9\u4E48\u4E00\u6BB5\u8BDD<code>\u4F7F\u7528 mode \u4E3A &quot;production&quot; \u7684\u914D\u7F6E\u9879\u4EE5\u542F\u7528\u66F4\u591A\u4F18\u5316\u9879\uFF0C\u5305\u62EC\u538B\u7F29\u4EE3\u7801\u4E0E tree shaking\u3002</code></p><p>\u56E0\u6B64\u5728<code>webpack5</code>\u4E2D\u53EA\u8981\u4F60\u8BBE\u7F6E<code>mode:production</code>\u90A3\u4E9B\u4EE3\u7801\u538B\u7F29\u3001<code>tree shaking</code>\u901A\u901A\u9ED8\u8BA4\u7ED9\u4F60\u505A\u4E86\u505A\u4E86\u6700\u5927\u7684\u4F18\u5316\uFF0C\u4F60\u5C31\u65E0\u9700\u64CD\u5FC3\u4EE3\u7801\u662F\u5426\u6709\u88AB\u538B\u7F29\uFF0C\u6216\u8005<code>tree shaking</code>\u4E86\u3002 <img src="https://img.soogif.com/UOkPg5REz1gR8YJNpWMBpagd78IhUwzk.gif?scope=mdnice" alt=""></p><p>\u5BF9\u4E8E\u80FD\u5426\u88AB<code>tree shaking</code>\u8FD8\u8865\u5145\u51E0\u70B9</p><p>1\u3001\u4E00\u5B9A\u662F<code>esModule</code>\u65B9\u5F0F\uFF0C\u4E5F\u5C31\u662F<code>export xxx</code>\u6216\u8005<code>import xx from &#39;xxx&#39;</code>\u7684\u65B9\u5F0F</p><p>2\u3001<code>cjs</code>\u65B9\u5F0F\u4E0D\u80FD\u88AB<code>tree shaking</code></p>`,8),N=n("3\u3001\u7EBF\u4E0A\u6253\u5305\u751F\u4EA7\u73AF\u5883"),A=s("code",null,"mode:production",-1),O=n("\u81EA\u52A8\u5F00\u542F\u591A\u9879\u4F18\u5316\uFF0C\u53EF\u4EE5\u53C2\u8003\u751F\u4EA7\u73AF\u5883\u7684\u6784\u5EFA"),$={href:"https://webpack.docschina.org/guides/production/",title:"production",target:"_blank",rel:"noopener noreferrer"},L=n("production"),I=a(`<h3 id="gizp-\u538B\u7F29" tabindex="-1"><a class="header-anchor" href="#gizp-\u538B\u7F29" aria-hidden="true">#</a> gizp \u538B\u7F29</h3><p>\u9996\u5148\u662F\u662F\u5728<code>devServer</code>\u4E0B\u63D0\u4F9B\u4E86\u4E00\u4E2A\u5F00\u53D1\u73AF\u5883\u7684<code>compress:true</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// \u542F\u7528zip\u538B\u7F29</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),V=n("CompressionWebpackPlugin \u63D2\u4EF6"),G={href:"https://webpack.docschina.org/plugins/compression-webpack-plugin/",title:"gizp",target:"_blank",rel:"noopener noreferrer"},B=n("gizp"),U=n("\u538B\u7F29"),R=a(`<p>\u9700\u8981\u5B89\u88C5\u5BF9\u5E94\u63D2\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm i compression<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>webpack.config.js</code>\u4E2D\u5F15\u5165\u63D2\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Generated using webpack-cli https://github.com/webpack/webpack-cli</span>
<span class="token operator">...</span>
<span class="token keyword">const</span> CompressionWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;compression-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// Add your plugins here</span>
    <span class="token comment">// Learn more about plugins from https://webpack.js.org/configuration/plugins/</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u4F60\u8FD0\u884C\u547D\u4EE4\u540E\uFF0C\u4F60\u5C31\u4F1A\u53D1\u73B0\u6253\u5305\u540E\u7684\u6587\u4EF6\u6709<code>gzip</code>\u7684\u6587\u4EF6\u4E86</p><p><img src="https://files.mdnice.com/user/24614/78e275ee-181a-4f4d-ac86-f873d89fe897.png" alt=""> \u4F46\u662F\u6211\u4EEC\u53D1\u73B0<code>html</code>\u4EE5\u53CA<code>map.js.map</code>\u6587\u4EF6\u4E5F\u88AB<code>gizp</code>\u538B\u7F29\u4E86\uFF0C\u8FD9\u662F\u6CA1\u6709\u5FC5\u8981\u7684</p><p>\u5B98\u65B9\u63D0\u4F9B\u4E86\u4E00\u4E2A<code>exclude</code>,\u53EF\u4EE5\u6392\u9664\u67D0\u4E9B\u6587\u4EF6\u4E0D\u88AB<code>gizp</code>\u538B\u7F29</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
   <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(html|map)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span> <span class="token comment">// \u6392\u9664html,map\u6587\u4EF6</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// Add your plugins here</span>
    <span class="token comment">// Learn more about plugins from https://webpack.js.org/configuration/plugins/</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://files.mdnice.com/user/24614/937b596d-db4a-4923-a0aa-1cc0b3a48090.png" alt=""></p><p>\u5BF9\u6BD4\u5F00\u542F<code>gizp</code>\u538B\u7F29\u4E0E\u672A\u538B\u7F29,\u52A0\u8F7D\u65F6\u95F4\u5F88\u660E\u663E\u6709\u63D0\u5347 <img src="https://files.mdnice.com/user/24614/95b3a34f-aab9-4774-ab5e-305d89efc60f.png" alt=""></p><h3 id="css-tree-shaking" tabindex="-1"><a class="header-anchor" href="#css-tree-shaking" aria-hidden="true">#</a> css tree shaking</h3><p>\u4E3B\u8981\u5220\u9664\u672A\u4F7F\u7528\u7684\u6837\u5F0F\uFF0C\u5982\u679C\u6837\u5F0F\u672A\u4F7F\u7528\uFF0C\u5C31\u5220\u9664\u6389\u3002</p><p>\u73B0\u5728\u4FEE\u6539\u4E0B<code>index.js</code> \u6211\u5728<code>body</code>\u4E2D\u63D2\u5165\u4E00\u4E2A<code>class</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;./utils/watch&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;./css/index.css&#39;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// /*#__PURE__*/ watchEnv(p<wbr>rocess.env.NODE_ENV)</span>

<span class="token keyword">const</span> bodyDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> divDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
divDom<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wrap-box&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bodyDom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>divDom<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5BF9\u5E94\u7684 css \u5982\u4E0B</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.wrap-box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C<code>npm run serve</code><img src="https://files.mdnice.com/user/24614/e2dee5f8-35ac-40d3-b79a-94b0e80045dd.png" alt=""> \u4F46\u662F\u6211\u4EEC\u53D1\u73B0\uFF0C\u6837\u5F0F\u5C45\u7136\u6CA1\u4E86</p><p>\u4E8E\u662F\u82E6\u601D\u7791\u60F3\uFF0C\u4E0D\u5F97\u5176\u89E3,\u4E8E\u662F\u4E00\u987F\u6392\u67E5\uFF0C\u5F53\u6211\u4EEC\u628A<code>sideEffects: false</code>\u65F6\uFF0C\u795E\u5947\u7684\u662F\uFF0C\u6837\u5F0F\u6CA1\u6709\u88AB\u5220\u6389 <img src="https://files.mdnice.com/user/24614/cf723a9f-b90e-4d3c-8dcb-a3654c141f98.png" alt=""> \u539F\u6765\u662F<code>sideEffects:true</code>\u628A\u5F15\u5165\u7684 css \u5F53\u6210\u6CA1\u6709\u526F\u4F5C\u7528\u7684\u4EE3\u7801\u7ED9\u5220\u9664\u4E86\uFF0C\u6B64\u65F6\uFF0C\u4F60\u9700\u8981\u544A\u8BC9<code>webpack</code>\u4E0D\u8981\u5220\u9664\u6211\u7684\u8FD9\u6709\u7528\u7684\u4EE3\u7801,\u4E0D\u8981\u8BEF\u5220\u4E86\uFF0C\u56E0\u4E3A<code>import &#39;xxx.css&#39;</code>\u5982\u679C\u8BBE\u7F6E\u4E86<code>sideEffects: true</code>\uFF0C\u6B64\u65F6\u5F15\u5165\u7684<code>css</code>\u4F1A\u88AB\u5F53\u6210\u65E0\u526F\u4F5C\u7528\u7684\u4EE3\u7801\uFF0C\u5C31\u7ED9\u5220\u9664\u4E86\u3002</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;**/*.css&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u4F60\u8BBE\u7F6E\u5B8C\u540E\uFF0C\u9875\u9762\u5C31\u53EF\u4EE5\u6B63\u5E38\u663E\u793A css \u4E86</p><p>\u5B98\u65B9\u4E5F\u63D0\u4F9B\u4E86\u53E6\u5916\u4E00\u79CD\u65B9\u6848\uFF0C\u4F60\u53EF\u4EE5\u5728<code>module.rules</code>\u4E2D\u8BBE\u7F6E</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token punctuation">{</span>
        test<span class="token operator">:</span> /\\.css$/i<span class="token punctuation">,</span>
        sideEffects<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>stylesHandler<span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;postcss-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0A\u4E0E\u5728<code>package.json</code>\u8BBE\u7F6E\u4E00\u6837\u7684\u6548\u679C\uFF0C\u90FD\u662F\u8BA9<code>webpack</code>\u4E0D\u8981\u8BEF\u5220\u4E86\u65E0\u526F\u4F5C\u7528\u7684 css \u7684\u4EE3\u7801</p><p>\u4F46\u662F\u73B0\u5728\u6709\u8FD9\u6837\u7684<code>css</code>\u4EE3\u7801</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.wrap-box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.title</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>title</code>\u9875\u9762\u6CA1\u6709\u88AB\u5F15\u7528\uFF0C\u4F46\u662F\u4E5F\u88AB\u6253\u5305\u8FDB\u53BB\u4E86</p>`,26),Y=n("\u6B64\u65F6\u9700\u8981\u4E00\u4E2A\u63D2\u4EF6\u6765\u5E2E\u52A9\u6211\u4EEC\u6765\u5B8C\u6210 css \u7684\u6447\u6811"),F={href:"https://www.npmjs.com/package/purgecss-webpack-plugin",title:"purgecss-webpack-plugin",target:"_blank",rel:"noopener noreferrer"},J=n("purgecss-webpack-plugin"),K=a(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;glob&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> PurgeCSSPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;purgecss-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PATH</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token keyword">new</span> <span class="token class-name">PurgeCSSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">paths</span><span class="token operator">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">PATH</span><span class="token punctuation">.</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">nodir</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// Add your plugins here</span>
    <span class="token comment">// Learn more about plugins from https://webpack.js.org/configuration/plugins/</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u672A\u5F15\u7528\u7684 css \u5C31\u5DF2\u7ECF\u88AB\u5220\u9664\u4E86 <img src="https://files.mdnice.com/user/24614/d9af57c5-ffe4-49cd-8a3d-d36c07449db1.png" alt=""></p><h3 id="\u5206\u5305" tabindex="-1"><a class="header-anchor" href="#\u5206\u5305" aria-hidden="true">#</a> \u5206\u5305</h3><p>\u4E3B\u8981\u662F\u51CF\u5C11\u5165\u53E3\u4F9D\u8D56\u6587\u4EF6\u5305\u7684\u4F53\u79EF\uFF0C\u5982\u679C\u4E0D\u8FDB\u884C\u62C6\u5305\uFF0C\u90A3\u4E48\u6211\u4EEC\u6839\u636E<code>entry</code>\u7684\u6587\u4EF6\u6253\u5305\u5C31\u5F88\u5927\u3002\u90A3\u4E48\u4E5F\u4F1A\u5F71\u54CD\u9996\u9875\u52A0\u8F7D\u7684\u6027\u80FD\u3002</p><p>\u5B98\u65B9\u63D0\u4F9B\u4E86\u4E24\u79CD\u65B9\u6848\uFF1A</p><ul><li>entry \u5206\u591A\u4E2A\u6587\u4EF6\uFF0C\u4E3E\u4E2A\u6817\u5B50</li></ul><p>\u5F15\u5165<code>loadsh</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./utils&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&#39;loadsh&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;./utils/watch&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;./css/index.css&#39;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// /*#__PURE__*/ watchEnv(p<wbr>rocess.env.NODE_ENV)</span>

<span class="token keyword">const</span> bodyDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> divDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
divDom<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wrap-box&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
divDom<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&#39;wrap-box&#39;</span><span class="token punctuation">;</span>
bodyDom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>divDom<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Maic&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Web\u6280\u672F\u5B66\u82D1&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://files.mdnice.com/user/24614/c0e1397b-d212-48ad-bd3f-22dea9d6c7d9.png" alt=""><code>main.js</code>\u4E2D\u5C06<code>loadsh</code>\u6253\u5305\u8FDB\u53BB\u4E86,\u4F53\u79EF\u4E5F\u975E\u5E38\u4E4B\u5927<code>72kb</code><img src="https://files.mdnice.com/user/24614/975cc315-b243-4a51-a522-60f6efea3dd7.png" alt=""></p><p>\u6211\u4EEC\u73B0\u5728\u5229\u7528<code>entry</code>\u8FDB\u884C\u5206\u5305</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">import</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;./src/index&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">dependOn</span><span class="token operator">:</span> <span class="token string">&#39;loadsh-vendors&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;loadsh-vendors&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;loadsh&#39;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u65F6\u6211\u4EEC\u518D\u6B21\u8FD0\u884C<code>npm run build:dev</code> \u6B64\u65F6<code>main.js</code>\u7684\u5927\u5C0F<code>1kb</code>\uFF0C\u4F46\u662F<code>loadsh</code>\u5DF2\u7ECF\u88AB\u5206\u79BB\u51FA\u6765\u4E86 <img src="https://files.mdnice.com/user/24614/f8ad63c5-378f-4736-82d2-dbdb69a86554.png" alt=""><img src="https://files.mdnice.com/user/24614/fd4caef1-a8e5-44a2-9e25-cf4e812e0156.png" alt=""> \u751F\u6210\u7684<code>loadsh-vendors.js</code>\u4F1A\u88AB\u5355\u72EC\u5F15\u5165</p><p>\u53EF\u4EE5\u770B\u4E0B\u6253\u5305\u540E\u7684<code>index.html</code></p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Webpack App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loadsh-vendors.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Tip: Check your console<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;serviceWorker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        navigator<span class="token punctuation">.</span>serviceWorker
          <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;service-worker.js&#39;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">registration</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Service Worker registered: &#39;</span><span class="token punctuation">,</span> registration<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">registrationError</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Service Worker registration failed: &#39;</span><span class="token punctuation">,</span> registrationError<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>splitChunks \u4E3B\u8981\u662F\u5728<code>optimzation.splitChunks</code>\u5BF9\u4E8E\u52A8\u6001\u5BFC\u5165\u6A21\u5757\uFF0C\u5728<code>webpack4+</code>\u5C31\u9ED8\u8BA4\u91C7\u53D6\u5206\u5757\u7B56\u7565</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// entry: {</span>
  <span class="token comment">//   main: { import: [&#39;./src/index&#39;], dependOn: &#39;loadsh-vendors&#39; },</span>
  <span class="token comment">//   &#39;loadsh-vendors&#39;: [&#39;loadsh&#39;]</span>
  <span class="token comment">// },</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">,</span>
      config<span class="token punctuation">.</span>optimization <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span> <span class="token comment">// \u652F\u6301\u5F02\u6B65\u548C\u975E\u5F02\u6B65\u5171\u4EABchunk</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">sideEffects</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5F00\u542Fterser</span>
        <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">extractComments</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u5C06\u6CE8\u91CA\u5265\u79BB\u5230\u5355\u72EC\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u662Ftrue</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53<code>optimization.splitChunks.chunks:&#39;all&#39;</code>,\u6B64\u65F6\u53EF\u4EE5\u628A<code>loash</code>\u5206\u5305\u51FA\u6765\u4E86 <img src="https://files.mdnice.com/user/24614/b3e726b9-bfb1-4f2b-b017-201351f619dd.png" alt=""></p>`,17),Q=n("\u5173\u4E8E"),X=s("code",null,"optimization.splitChunks",-1),Z=n("\u7684\u8BBE\u7F6E\u975E\u5E38\u4E4B\u591A\uFF0C\u6709\u5BF9\u7F13\u5B58\u7684\u8BBE\u7F6E\uFF0C\u6709\u5BF9"),nn=s("code",null,"chunk",-1),sn=n("\u5927\u5C0F\u7684\u9650\u5236\uFF0C\u6700\u5E38\u7528\u7684\u8FD8\u662F\u8BBE\u7F6E"),an=s("code",null,"chunks:all",-1),pn=n("\uFF0C\u5EFA\u8BAE"),en={href:"https://webpack.docschina.org/plugins/split-chunks-plugin/",title:"SplitChunksPlugin",target:"_blank",rel:"noopener noreferrer"},tn=n("SplitChunksPlugin"),on=n("\u591A\u8BFB\u51E0\u904D,\u4E00\u5B9A\u4F1A\u627E\u5230\u4E0D\u5C11\u6536\u83B7\u3002"),cn=a(`<ul><li>runtimeChunk \u4E3B\u8981\u51CF\u5C11\u4F9D\u8D56\u5165\u53E3\u6587\u4EF6\u6253\u5305\u4F53\u79EF\uFF0C\u5F53\u6211\u4EEC\u8BBE\u7F6E<code>optimization.runtimeChunk</code>\u65F6\uFF0C\u8FD0\u884C\u65F6\u4F9D\u8D56\u7684\u4EE3\u7801\u4F1A\u72EC\u7ACB\u6253\u5305\u6210\u4E00\u4E2A<code>runtime.xxx.js</code></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
  config<span class="token punctuation">.</span>optimization <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u51CF\u5C11\u5165\u53E3\u6587\u4EF6\u6253\u5305\u7684\u4F53\u79EF\uFF0C\u8FD0\u884C\u65F6\u4EE3\u7801\u4F1A\u72EC\u7ACB\u62BD\u79BB\u6210\u4E00\u4E2Aruntime\u7684\u6587\u4EF6</span>
        <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// \u9ED8\u8BA4\u662F1\uFF0C\u53EF\u4EE5\u4E0D\u8BBE\u7F6E</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u652F\u6301\u5F02\u6B65\u548C\u975E\u5F02\u6B65\u5171\u4EABchunk</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">sideEffects</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5F00\u542Fterser</span>
        <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">extractComments</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u5C06\u6CE8\u91CA\u5265\u79BB\u5230\u5355\u72EC\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u662Ftrue</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>main.js</code>\u6709\u4E00\u90E8\u5206\u4EE3\u7801\u79FB\u9664\u5230\u4E00\u4E2A\u72EC\u7ACB\u7684<code>runtime.js</code>\u4E2D <img src="https://files.mdnice.com/user/24614/07da67f1-be68-4bc6-a786-59e3845eb0a9.png" alt=""></p>`,3),ln=n("Externals \u5916\u90E8\u6269\u5C55 \u7B2C\u4E09\u79CD\u65B9\u6848\u5C31\u662F\uFF0C"),un=s("code",null,"webpack",-1),rn=n("\u63D0\u4F9B\u4E86\u4E00\u4E2A\u5916\u90E8\u6269\u5C55\uFF0C\u5C06\u8F93\u51FA\u7684"),dn=s("code",null,"bundle.js",-1),kn=n("\u6392\u9664\u7B2C\u4E09\u65B9\u7684\u4F9D\u8D56\uFF0C\u53C2\u8003"),vn={href:"https://webpack.docschina.org/configuration/externals/",title:"Externals",target:"_blank",rel:"noopener noreferrer"},mn=n("Externals"),bn=a(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// entry: {</span>
  <span class="token comment">//   main: { import: [&#39;./src/index&#39;], dependOn: &#39;loadsh-vendors&#39; },</span>
  <span class="token comment">//   &#39;loadsh-vendors&#39;: [&#39;loadsh&#39;]</span>
  <span class="token comment">// },</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token operator">...</span><span class="token punctuation">,</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(loadsh)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
  <span class="token comment">/* or
  externals: {
    loadsh: &#39;_&#39;
  }
  */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">,</span>
      config<span class="token punctuation">.</span>optimization <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">runtimeChunk</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u51CF\u5C11\u5165\u53E3\u6587\u4EF6\u6253\u5305\u7684\u4F53\u79EF\uFF0C\u8FD0\u884C\u65F6\u4EE3\u7801\u4F1A\u72EC\u7ACB\u62BD\u79BB\u6210\u4E00\u4E2Aruntime\u7684\u6587\u4EF6</span>
        <span class="token comment">// splitChunks: {</span>
        <span class="token comment">//   minChunks: 1,</span>
        <span class="token comment">//   chunks: &#39;all&#39;, // \u652F\u6301\u5F02\u6B65\u548C\u975E\u5F02\u6B65\u5171\u4EABchunk</span>
        <span class="token comment">// },</span>
        <span class="token literal-property property">sideEffects</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5F00\u542Fterser</span>
        <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">extractComments</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u5C06\u6CE8\u91CA\u5265\u79BB\u5230\u5355\u72EC\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u662Ftrue</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F46\u662F\u6B64\u65F6<code>loash</code>\u5DF2\u7ECF\u88AB\u6211\u4EEC\u79FB\u9664\u4E86\uFF0C\u6211\u4EEC\u8FD8\u9700\u5728<code>HtmlWebpackPlugin</code>\u4E2D\u52A0\u5165\u5F15\u5165\u7684<code>cdn</code>\u5730\u5740</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
 <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token string">&#39;body&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u63D2\u5165\u5230body\u4E2D</span>
      <span class="token literal-property property">cdn</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">basePath</span><span class="token operator">:</span> <span class="token string">&#39;https://cdn.bootcdn.net/ajax/libs&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">js</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&#39;/lodash.js/4.17.21/lodash.min.js&#39;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),gn=n("\u4FEE\u6539\u6A21\u7248,\u7531\u4E8E\u6A21\u7248\u5185\u5BB9\u662F"),hn={href:"https://ejs.bootcss.com/#docs",title:"ejs",target:"_blank",rel:"noopener noreferrer"},yn=n("ejs"),fn=n("\uFF0C\u6240\u4EE5\u6211\u4EEC\u5FAA\u73AF\u53D6\u51FA"),wn=s("code",null,"js",-1),_n=n("\u6570\u7EC4\u4E2D\u7684\u6570\u636E"),xn=a(`<div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Webpack App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Tip: Check your console<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    &lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp; htmlWebpackPlugin.options.cdn.js) { %&gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= htmlWebpackPlugin.options.cdn.basePath %&gt;&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    &lt;% } %&gt;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;serviceWorker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        navigator<span class="token punctuation">.</span>serviceWorker
          <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;service-worker.js&#39;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">registration</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Service Worker registered: &#39;</span><span class="token punctuation">,</span> registration<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">registrationError</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Service Worker registration failed: &#39;</span><span class="token punctuation">,</span> registrationError<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u65F6\u4F60\u8FD0\u884C\u547D\u4EE4<code>npm run build:dev</code>,\u7136\u540E\u6253\u5F00 html \u9875\u9762 <img src="https://files.mdnice.com/user/24614/18577504-a0c1-465b-b367-b74a40cb2f43.png" alt=""></p><p>\u4F46\u662F\u6211\u4EEC\u53D1\u73B0\u5F53\u6211\u4EEC\u8FD0\u884C<code>npm run serve</code>\u542F\u52A8\u672C\u5730\u670D\u52A1\uFF0C\u6B64\u65F6\u9875\u9762\u8FD8\u662F\u4F1A\u5F15\u5165<code>loadsh</code>\uFF0C\u5728\u5F00\u53D1\u73AF\u5883\uFF0C\u5176\u5B9E\u5E76\u4E0D\u9700\u8981\u5F15\u5165\uFF0C\u672C\u8EAB\u751F\u6210\u7684<code>bundle.js</code>\u5C31\u662F\u5728\u5185\u5B58\u4E2D\u52A0\u8F7D\u7684\uFF0C\u5F88\u663E\u7136\u4E0D\u662F\u6211\u4EEC\u9700\u8981\u7684</p><p>\u6B64\u65F6\u6211\u9700\u8981\u505A\u51E0\u4EF6\u4E8B</p><p>1\u3001\u5F00\u53D1\u73AF\u5883\u6211\u4E0D\u5141\u8BB8\u5F15\u5165<code>externals</code></p><p>2\u3001\u6A21\u7248<code>html</code>\u4E2D\u9700\u8981\u6839\u636E\u73AF\u5883\u5224\u65AD\u662F\u5426\u9700\u8981\u63D2\u5165<code>cdn</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">const</span> isProduction <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">==</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stylesHandler <span class="token operator">=</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PATH</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;src&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// entry: {</span>
  <span class="token comment">//   main: { import: [&#39;./src/index&#39;], dependOn: &#39;loadsh-vendors&#39; },</span>
  <span class="token comment">//   &#39;loadsh-vendors&#39;: [&#39;loadsh&#39;]</span>
  <span class="token comment">// },</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">env</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">,</span> <span class="token comment">// \u4F20\u5165\u6A21\u7248\u4E2D\u7684\u73AF\u5883</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token string">&#39;body&#39;</span><span class="token punctuation">,</span> <span class="token comment">// \u63D2\u5165\u5230body\u4E2D</span>
      <span class="token literal-property property">cdn</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">basePath</span><span class="token operator">:</span> <span class="token string">&#39;https://cdn.bootcdn.net/ajax/libs&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">js</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&#39;/lodash.js/4.17.21/lodash.min.js&#39;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(html|map)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span> <span class="token comment">// \u6392\u9664html,map\u6587\u4EF6\u4E0D\u505Agizp\u538B\u7F29</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">PurgeCSSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">paths</span><span class="token operator">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">PATH</span><span class="token punctuation">.</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">nodir</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// Add your plugins here</span>
    <span class="token comment">// Learn more about plugins from https://webpack.js.org/configuration/plugins/</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
  <span class="token comment">// externals: /^(loadsh)$/i,</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> isProduction <span class="token operator">?</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loadsh</span><span class="token operator">:</span> <span class="token string">&#39;_&#39;</span>
  <span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6839\u636E\u4F20\u5165\u6A21\u7248\u7684<code>env</code>\u5224\u65AD\u662F\u5426\u9700\u8981\u63D2\u5165 cdn</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>... &lt;% if (htmlWebpackPlugin.options.env === &#39;production&#39;) { %&gt; &lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp; htmlWebpackPlugin.options.cdn.js) { %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%= htmlWebpackPlugin.options.cdn.basePath %&gt;&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
&lt;% } %&gt; &lt;% } %&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u56FE\u7247\u8D44\u6E90\u538B\u7F29" tabindex="-1"><a class="header-anchor" href="#\u56FE\u7247\u8D44\u6E90\u538B\u7F29" aria-hidden="true">#</a> \u56FE\u7247\u8D44\u6E90\u538B\u7F29</h3><p>\u4E3B\u8981\u662F\u6709\u9009\u62E9\u7684\u538B\u7F29\u56FE\u7247\u8D44\u6E90\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u4E0B<code>module.rules.parser</code></p><ul><li>module.rules.parser.dataUrlCondition \u5BF9\u5E94\u7684\u8D44\u6E90\u6587\u4EF6\u53EF\u4EE5\u9650\u5236\u56FE\u7247\u7684\u8F93\u51FA,\u6BD4\u5982\u9759\u6001\u8D44\u6E90\u6A21\u5757\u7C7B\u578B</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(png|svg|jpg|jpeg|gif)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;asset/resource&#39;</span><span class="token punctuation">,</span>
       <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// \u5C0F\u4E8E4kb\u5C06\u4F1Abase64\u8F93\u51FA</span>
         <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),jn=n("\u5B98\u65B9\u63D0\u4F9B\u4E86\u4E00\u4E2A"),qn={href:"https://webpack.docschina.org/plugins/image-minimizer-webpack-plugin/",title:"ImageMinimizerWebpackPlugin",target:"_blank",rel:"noopener noreferrer"},En=n("ImageMinimizerWebpackPlugin"),Pn=n(" \u6211\u4EEC\u9700\u8981\u5B89\u88C5"),zn=a(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm i image<span class="token operator">-</span>minimizer<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin imagemin <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,1),Wn=n("\u5728"),Cn=s("code",null,"webpack.config.js",-1),Sn=n("\u4E2D\u5F15\u5165"),Mn=s("code",null,"image-minimizer-webpack-plugin",-1),Hn=n(",\u5E76\u4E14\u5728"),Tn=s("code",null,"plugins",-1),Dn=n("\u4E2D\u5F15\u5165\u8FD9\u4E2A\u63D2\u4EF6,\u6CE8\u610F"),Nn=s("code",null,"webpack5",-1),An=n("\u5B98\u7F51\u90A3\u4EFD\u6587\u6863\u5F88\u65E7\uFF0C\u53C2\u8003"),On=s("code",null,"npm",-1),$n=n("\u4E0A"),Ln={href:"https://www.npmjs.com/package/image-minimizer-webpack-plugin",title:"npm-image-minimizer-webpack-plugin",target:"_blank",rel:"noopener noreferrer"},In=n("npm-image-minimizer-webpack-plugin"),Vn=a(`<p>\u6309\u7167\u5B98\u7F51\u7684\uFF0C\u5C31\u76F4\u63A5\u62A5\u9519\u4E00\u4E9B\u914D\u7F6E\u53C2\u6570\u4E0D\u5B58\u5728\uFF0C\u6211\u4F30\u8BA1\u6587\u6863\u6CA1\u53CA\u65F6\u66F4\u65B0</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> ImageMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;image-minimizer-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
   <span class="token operator">...</span>
    <span class="token keyword">new</span> <span class="token class-name">ImageMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// Implementation</span>
        <span class="token literal-property property">implementation</span><span class="token operator">:</span> ImageMinimizerPlugin<span class="token punctuation">.</span>squooshMinify<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// Add your plugins here</span>
    <span class="token comment">// Learn more about plugins from https://webpack.js.org/configuration/plugins/</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u672A\u538B\u7F29\u524D <img src="https://files.mdnice.com/user/24614/5e1ad262-bdce-485a-b698-57f9a6600da8.png" alt=""></p><p>\u538B\u7F29\u540E</p><p><img src="https://files.mdnice.com/user/24614/f15cf267-d7b1-436a-8091-5fca113f8403.png" alt=""> \u4F7F\u7528\u538B\u7F29\u540E\uFF0C\u56FE\u7247\u65E0\u635F\u538B\u7F29\u4F53\u79EF\u5927\u5C0F\u538B\u7F29\u5927\u5C0F\u7F29\u5C0F\u4E00\u534A\uFF0C\u5E76\u4E14\u7F51\u7EDC\u52A0\u8F7D\u56FE\u7247\u65F6\u95F4\u4ECE<code>18.87ms</code>\u51CF\u5C11\u5230<code>4.81ms</code>,\u65F6\u95F4\u52A0\u8F7D\u4E0A\u63A5\u8FD1 5 \u500D\u7684\u5DEE\u8DDD\uFF0C\u56E0\u6B64\u53EF\u4EE5\u7528\u8FD9\u4E2A\u63D2\u4EF6\u6765\u4F18\u5316\u56FE\u7247\u52A0\u8F7D\u3002</p><p>\u8FD9\u4E2A\u63D2\u4EF6\u53EF\u4EE5\u5C06\u56FE\u7247\u8F6C\u6210<code>webp</code>\u683C\u5F0F\uFF0C\u5177\u4F53\u53C2\u8003\u5B98\u65B9\u6587\u6863\u6548\u679C\u6D4B\u8BD5\u4E00\u4E0B</p><h3 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h3><p>1\u3001<code>webpack</code>\u5982\u4F55\u505A<code>treeShaking</code>\uFF0C\u4E3B\u8981\u662F\u4E24\u79CD</p><ul><li>optimization \u4E2D\u8BBE\u7F6E<code>usedExports:true</code>\uFF0C\u4F46\u662F\u8981\u914D\u5408<code>terser</code>\u538B\u7F29\u63D2\u4EF6\u624D\u4F1A\u751F\u6548</li><li>optimization \u4E2D\u8BBE\u7F6E<code>sideEffects: true</code>,\u5728<code>package.json</code>\u4E2D\u8BBE\u7F6E<code>sideEffects:false</code>\u53BB\u9664\u65E0\u526F\u4F5C\u7528\u7684\u4EE3\u7801\uFF0C\u4F46\u662F\u6CE8\u610F<code>css</code>\u5F15\u5165\u4F1A\u5F53\u6210\u65E0\u526F\u4F5C\u7528\u7684\u4EE3\u7801\uFF0C\u6B64\u65F6\u9700\u8981\u5728 rules \u7684 css \u89C4\u5219\u4E2D\u6807\u8BB0<code>sideEffects: true</code>,\u8FD9\u6837\u5C31\u4E0D\u4F1A\u5220\u9664 css \u4E86</li></ul><p>2\u3001<code>webpack</code>\u7684 gizp \u538B\u7F29 \u4E3B\u8981\u662F\u5229\u7528<code>CompressionWebpackPlugin</code>\u5B98\u65B9\u63D0\u4F9B\u7684\u8FD9\u4E2A\u63D2\u4EF6</p><p>3\u3001<code>css</code>\u5982\u4F55\u505A<code>treeShaking</code>, \u4E3B\u8981\u662F\u5229\u7528<code>PurgeCSSPlugin</code>\u8FD9\u4E2A\u63D2\u4EF6\uFF0C\u4F1A\u5C06\u6CA1\u6709\u5F15\u7528 css \u5220\u9664</p><p>4\u3001\u5165\u53E3\u4F9D\u8D56\u6587\u4EF6\u62C6\u5305</p>`,12),Gn=a("<li>\u7B2C\u4E00\u79CD\u662F\u5728\u5165\u53E3\u6587\u4EF6<code>entry</code>\u4E2D\u5206\u5305\u5904\u7406\uFF0C\u5C06\u4F9D\u8D56\u7684\u7B2C\u4E09\u65B9\u5E93\u72EC\u7ACB\u6253\u5305\u6210\u4E00\u4E2A\u516C\u7528\u7684<code>bundle.js</code>,\u5165\u53E3\u6587\u4EF6\u4E0D\u4F1A\u628A\u7B2C\u4E09\u65B9\u5305\u6253\u5305\u5230\u91CC\u9762\u53BB</li><li>\u7B2C\u4E8C\u79CD\u5229\u7528<code>optimization.splitChunks</code>\u8BBE\u7F6E<code>chunks:&#39;all&#39;</code>\u5C06\u540C\u6B65\u6216\u8005\u5F02\u6B65\u7684<code>esModule</code>\u65B9\u5F0F\u7684\u4EE3\u7801\u8FDB\u884C\u5206\u5305\u5904\u7406\uFF0C\u4F1A\u5355\u72EC\u6253\u6210\u4E00\u4E2A\u516C\u7528\u7684 js</li><li>\u5229\u7528\u5916\u7F6E\u6269\u5C55<code>externals</code>\u5C06\u7B2C\u4E09\u65B9\u5305\u5206\u79BB\u51FA\u53BB\uFF0C\u6B64\u65F6\u7B2C\u4E09\u65B9\u5305\u4E0D\u4F1A\u6253\u5305\u5230\u5165\u53E3\u6587\u4EF6\u4E2D\u53BB\uFF0C\u4E0D\u8FC7\u6CE8\u610F\u8981\u5728<code>ejs</code>\u6A21\u7248\u4E2D\u8FDB\u884C\u5355\u72EC\u5F15\u5165 5\u3001<code>\u56FE\u7247\u8D44\u6E90</code>\u52A0\u8F7D\u4F18\u5316</li><li>\u4E3B\u8981\u662F\u5229\u7528\u9759\u6001\u8D44\u6E90\u6A21\u5757\u5BF9\u6587\u4EF6\u4F53\u79EF\u5C0F\u7684\u53EF\u4EE5\u8FDB\u884C base64</li>",4),Bn=n("\u5229\u7528\u793E\u533A\u63D2\u4EF6"),Un=s("code",null,"image-minimizer-webpack-plugin",-1),Rn=n("\u505A\u56FE\u7247\u538B\u7F29\u5904\u7406 6\u3001\u672C\u6587\u793A\u4F8B"),Yn={href:"https://github.com/maicFir/lessonNote/tree/master/webpack/webpack-08-tree-shaking",title:"code-example",target:"_blank",rel:"noopener noreferrer"},Fn=n("code-example");function Jn(Kn,Qn){const p=l("ExternalLinkIcon");return o(),c("div",null,[u,s("p",null,[r,s("a",d,[k,e(p)]),v,m,b,g,h,y,f,w,_]),x,s("p",null,[j,q,E,P,z,W,C,S,M,s("a",H,[T,e(p)])]),D,s("p",null,[N,A,O,s("a",$,[L,e(p)])]),I,s("ul",null,[s("li",null,[V,s("a",G,[B,e(p)]),U])]),R,s("p",null,[Y,s("a",F,[J,e(p)])]),K,s("p",null,[Q,X,Z,nn,sn,an,pn,s("a",en,[tn,e(p)]),on]),cn,s("ul",null,[s("li",null,[ln,un,rn,dn,kn,s("a",vn,[mn,e(p)])])]),bn,s("p",null,[gn,s("a",hn,[yn,e(p)]),fn,wn,_n]),xn,s("p",null,[jn,s("a",qn,[En,e(p)]),Pn]),zn,s("p",null,[Wn,Cn,Sn,Mn,Hn,Tn,Dn,Nn,An,On,$n,s("a",Ln,[In,e(p)])]),Vn,s("ul",null,[Gn,s("li",null,[Bn,Un,Rn,s("a",Yn,[Fn,e(p)])])])])}var Zn=t(i,[["render",Jn],["__file","2022-06-24.html.vue"]]);export{Zn as default};
