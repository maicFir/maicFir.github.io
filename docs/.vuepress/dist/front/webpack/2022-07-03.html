<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/n_logo.png"><link rel="manifest" href="/manifest.webmanifest.json"><meta name="viewport" content="width=device-width,width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta name="referrer" content="no-referrer"><meta data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><title>放弃webpack,拥抱gulp | Web技术学院</title><meta name="description" content="专注前端技术，分享web技术">
    <link rel="modulepreload" href="/assets/app.d833009d.js"><link rel="modulepreload" href="/assets/2022-07-03.html.91c9d145.js"><link rel="modulepreload" href="/assets/2022-07-03.html.251d2947.js"><link rel="prefetch" href="/assets/index.html.b0267837.js"><link rel="prefetch" href="/assets/config.html.11061a56.js"><link rel="prefetch" href="/assets/index.html.48af1cdf.js"><link rel="prefetch" href="/assets/2022-05-08.html.f67fc422.js"><link rel="prefetch" href="/assets/2022-07-22.html.9f3dd1c4.js"><link rel="prefetch" href="/assets/index.html.56394ab8.js"><link rel="prefetch" href="/assets/2022-01-07.html.acef6471.js"><link rel="prefetch" href="/assets/2022-01-30.html.040b1196.js"><link rel="prefetch" href="/assets/2022-02-15.html.f38b6d77.js"><link rel="prefetch" href="/assets/2022-03-21.html.844a393d.js"><link rel="prefetch" href="/assets/2022-03-29.html.e8a1a3c6.js"><link rel="prefetch" href="/assets/2022-04-10.html.b4441b34.js"><link rel="prefetch" href="/assets/2022-04-13.html.277a9601.js"><link rel="prefetch" href="/assets/2022-04-28.html.1d05a0ae.js"><link rel="prefetch" href="/assets/2022-05-01.html.5379acad.js"><link rel="prefetch" href="/assets/2022-05-02.html.15f49d31.js"><link rel="prefetch" href="/assets/2022-05-10.html.89c02d16.js"><link rel="prefetch" href="/assets/2022-05-12.html.e0cd8ba0.js"><link rel="prefetch" href="/assets/2022-05-25.html.b1c99843.js"><link rel="prefetch" href="/assets/2022-06-15.html.71223634.js"><link rel="prefetch" href="/assets/2022-06-27.html.d3acaf23.js"><link rel="prefetch" href="/assets/2022-07-12.html.691877e9.js"><link rel="prefetch" href="/assets/2022-07-14.html.73b946c9.js"><link rel="prefetch" href="/assets/Advance.html.0d332483.js"><link rel="prefetch" href="/assets/index.html.5bb90c9b.js"><link rel="prefetch" href="/assets/2022-04-17.html.8df2755a.js"><link rel="prefetch" href="/assets/2022-05-03.html.7b1fe926.js"><link rel="prefetch" href="/assets/2022-05-17.html.4824b234.js"><link rel="prefetch" href="/assets/2022-05-27.html.d17f420d.js"><link rel="prefetch" href="/assets/2022-05-29.html.fdfee9c7.js"><link rel="prefetch" href="/assets/index.html.eb03efab.js"><link rel="prefetch" href="/assets/2022-01-11.html.d3379b31.js"><link rel="prefetch" href="/assets/index.html.7ed74cb4.js"><link rel="prefetch" href="/assets/2022-03-07.html.69a705fd.js"><link rel="prefetch" href="/assets/index.html.fb3c0761.js"><link rel="prefetch" href="/assets/2022-06-03.html.3597757e.js"><link rel="prefetch" href="/assets/2022-06-05.html.0cbb117d.js"><link rel="prefetch" href="/assets/2022-06-07.html.423f7dfb.js"><link rel="prefetch" href="/assets/2022-06-10.html.f791a2f7.js"><link rel="prefetch" href="/assets/2022-06-14.html.c3b8d4ad.js"><link rel="prefetch" href="/assets/2022-06-15.html.b78bae04.js"><link rel="prefetch" href="/assets/2022-06-21.html.b65dfa8b.js"><link rel="prefetch" href="/assets/2022-06-24.html.42456bbb.js"><link rel="prefetch" href="/assets/2022-06-29.html.58b78e02.js"><link rel="prefetch" href="/assets/2022-07-05.html.5f8d31e1.js"><link rel="prefetch" href="/assets/2022-07-06.html.bb1407ba.js"><link rel="prefetch" href="/assets/2022-07-10.html.61003676.js"><link rel="prefetch" href="/assets/index.html.2b1ae216.js"><link rel="prefetch" href="/assets/index.html.7b6ad27f.js"><link rel="prefetch" href="/assets/2022-01-15.html.d7e47800.js"><link rel="prefetch" href="/assets/2022-05-20.html.46e85dda.js"><link rel="prefetch" href="/assets/2022-05-23.html.d0c66290.js"><link rel="prefetch" href="/assets/index.html.a2a904fc.js"><link rel="prefetch" href="/assets/404.html.265028f6.js"><link rel="prefetch" href="/assets/index.html.4d038b03.js"><link rel="prefetch" href="/assets/config.html.56784399.js"><link rel="prefetch" href="/assets/index.html.27d13e65.js"><link rel="prefetch" href="/assets/2022-05-08.html.691eb475.js"><link rel="prefetch" href="/assets/2022-07-22.html.0676b5f4.js"><link rel="prefetch" href="/assets/index.html.71474329.js"><link rel="prefetch" href="/assets/2022-01-07.html.51297f21.js"><link rel="prefetch" href="/assets/2022-01-30.html.577641e4.js"><link rel="prefetch" href="/assets/2022-02-15.html.9c01fbe1.js"><link rel="prefetch" href="/assets/2022-03-21.html.8244eaa2.js"><link rel="prefetch" href="/assets/2022-03-29.html.16d0af07.js"><link rel="prefetch" href="/assets/2022-04-10.html.b19b26be.js"><link rel="prefetch" href="/assets/2022-04-13.html.f472eed3.js"><link rel="prefetch" href="/assets/2022-04-28.html.3029ad1b.js"><link rel="prefetch" href="/assets/2022-05-01.html.98b0b1ec.js"><link rel="prefetch" href="/assets/2022-05-02.html.cc90fb85.js"><link rel="prefetch" href="/assets/2022-05-10.html.9b2820ec.js"><link rel="prefetch" href="/assets/2022-05-12.html.a760cfea.js"><link rel="prefetch" href="/assets/2022-05-25.html.4bb6c505.js"><link rel="prefetch" href="/assets/2022-06-15.html.b3362032.js"><link rel="prefetch" href="/assets/2022-06-27.html.0ceda731.js"><link rel="prefetch" href="/assets/2022-07-12.html.2075d6ed.js"><link rel="prefetch" href="/assets/2022-07-14.html.11c64a92.js"><link rel="prefetch" href="/assets/Advance.html.f895687b.js"><link rel="prefetch" href="/assets/index.html.c3f59808.js"><link rel="prefetch" href="/assets/2022-04-17.html.8e32dd63.js"><link rel="prefetch" href="/assets/2022-05-03.html.80b61565.js"><link rel="prefetch" href="/assets/2022-05-17.html.6eeaa92e.js"><link rel="prefetch" href="/assets/2022-05-27.html.313c5efa.js"><link rel="prefetch" href="/assets/2022-05-29.html.9f8fd85d.js"><link rel="prefetch" href="/assets/index.html.066d4c7c.js"><link rel="prefetch" href="/assets/2022-01-11.html.725ef3da.js"><link rel="prefetch" href="/assets/index.html.a072f078.js"><link rel="prefetch" href="/assets/2022-03-07.html.97818393.js"><link rel="prefetch" href="/assets/index.html.6d960dcd.js"><link rel="prefetch" href="/assets/2022-06-03.html.6f798008.js"><link rel="prefetch" href="/assets/2022-06-05.html.a594eca1.js"><link rel="prefetch" href="/assets/2022-06-07.html.2e1bd57e.js"><link rel="prefetch" href="/assets/2022-06-10.html.23270525.js"><link rel="prefetch" href="/assets/2022-06-14.html.48bc51ce.js"><link rel="prefetch" href="/assets/2022-06-15.html.93c37e21.js"><link rel="prefetch" href="/assets/2022-06-21.html.d6e86ef5.js"><link rel="prefetch" href="/assets/2022-06-24.html.4a4052a8.js"><link rel="prefetch" href="/assets/2022-06-29.html.7d6fd416.js"><link rel="prefetch" href="/assets/2022-07-05.html.f212fe4f.js"><link rel="prefetch" href="/assets/2022-07-06.html.b07549bc.js"><link rel="prefetch" href="/assets/2022-07-10.html.5102c21f.js"><link rel="prefetch" href="/assets/index.html.3f1724ee.js"><link rel="prefetch" href="/assets/index.html.076f87d3.js"><link rel="prefetch" href="/assets/2022-01-15.html.c769f444.js"><link rel="prefetch" href="/assets/2022-05-20.html.8a6dae07.js"><link rel="prefetch" href="/assets/2022-05-23.html.5a4917e8.js"><link rel="prefetch" href="/assets/index.html.af8049bc.js"><link rel="prefetch" href="/assets/404.html.72eb2baa.js"><link rel="prefetch" href="/assets/404.66c455be.js"><link rel="prefetch" href="/assets/Layout.29ad6933.js"><link rel="prefetch" href="/assets/ActionFied.43e5225a.js"><link rel="prefetch" href="/assets/index.0e8935cb.js">
    <link rel="stylesheet" href="/assets/style.365ddc46.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Web技术学院</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Web技术"><span class="title">Web技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Web技术"><span class="title">Web技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/front/js/" class="" aria-label="JS"><!--[--><!--]--> JS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/front/css/" class="" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>框架</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/front/frame/vue/" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/front/frame/react/" class="" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><a href="/front/leetcode/" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/front/ts/" class="" aria-label="TS"><!--[--><!--]--> TS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/front/node/" class="" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工程化"><span class="title">工程化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工程化"><span class="title">工程化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/front/webpack/" class="router-link-active" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="社交"><span class="title">社交</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="社交"><span class="title">社交</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://juejin.cn/user/4142615542920680" rel="noopener noreferrer" target="_blank" aria-label="掘金"><!--[--><!--]--> 掘金 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://segmentfault.com/u/maicfir" rel="noopener noreferrer" target="_blank" aria-label="segmentfault"><!--[--><!--]--> segmentfault <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/maicFir/lessonNote" rel="noopener noreferrer" target="_blank" aria-label="github"><!--[--><!--]--> github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/maicFir/maicFir.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Web技术"><span class="title">Web技术</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Web技术"><span class="title">Web技术</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/front/js/" class="" aria-label="JS"><!--[--><!--]--> JS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/front/css/" class="" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>框架</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/front/frame/vue/" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/front/frame/react/" class="" aria-label="react"><!--[--><!--]--> react <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><a href="/front/leetcode/" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/front/ts/" class="" aria-label="TS"><!--[--><!--]--> TS <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/front/node/" class="" aria-label="node"><!--[--><!--]--> node <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工程化"><span class="title">工程化</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工程化"><span class="title">工程化</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/front/webpack/" class="router-link-active" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="社交"><span class="title">社交</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="社交"><span class="title">社交</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://juejin.cn/user/4142615542920680" rel="noopener noreferrer" target="_blank" aria-label="掘金"><!--[--><!--]--> 掘金 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://segmentfault.com/u/maicfir" rel="noopener noreferrer" target="_blank" aria-label="segmentfault"><!--[--><!--]--> segmentfault <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/maicFir/lessonNote" rel="noopener noreferrer" target="_blank" aria-label="github"><!--[--><!--]--> github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/maicFir/maicFir.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active"> <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/front/webpack/" class="router-link-active sidebar-item" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-03.html" class="sidebar-item" aria-label="webpack从0到1构建"><!--[--><!--]--> webpack从0到1构建 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-05.html" class="sidebar-item" aria-label="webpack构建自定义react应用"><!--[--><!--]--> webpack构建自定义react应用 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-07.html" class="sidebar-item" aria-label="webpack构建自定义vue应用"><!--[--><!--]--> webpack构建自定义vue应用 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-10.html" class="sidebar-item" aria-label="webpack5资源最佳加载方案"><!--[--><!--]--> webpack5资源最佳加载方案 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-14.html" class="sidebar-item" aria-label="揭秘webpack5模块打包"><!--[--><!--]--> 揭秘webpack5模块打包 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-15.html" class="sidebar-item" aria-label="项目eslint从零到一"><!--[--><!--]--> 项目eslint从零到一 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-21.html" class="sidebar-item" aria-label="WDS必知必会"><!--[--><!--]--> WDS必知必会 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-24.html" class="sidebar-item" aria-label="爆肝总结万字长文笔记webpack5打包资源优化"><!--[--><!--]--> 爆肝总结万字长文笔记webpack5打包资源优化 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-06-29.html" class="sidebar-item" aria-label="webpack5构建一个通用的组件库"><!--[--><!--]--> webpack5构建一个通用的组件库 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="放弃webpack,拥抱gulp"><!--[--><!--]--> 放弃webpack,拥抱gulp <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/front/webpack/2022-07-03.html#搭建一个简单的前端应用" class="router-link-active router-link-exact-active sidebar-item" aria-label="搭建一个简单的前端应用"><!--[--><!--]--> 搭建一个简单的前端应用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#安装-less" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装 less"><!--[--><!--]--> 安装 less <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#图片资源" class="router-link-active router-link-exact-active sidebar-item" aria-label="图片资源"><!--[--><!--]--> 图片资源 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#组合任务-series-与-parallel" class="router-link-active router-link-exact-active sidebar-item" aria-label="组合任务 series 与 parallel"><!--[--><!--]--> 组合任务 series 与 parallel <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#编译转换-es6" class="router-link-active router-link-exact-active sidebar-item" aria-label="编译转换 es6"><!--[--><!--]--> 编译转换 es6 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#压缩-js-与-css" class="router-link-active router-link-exact-active sidebar-item" aria-label="压缩 js 与 css"><!--[--><!--]--> 压缩 js 与 css <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#将资源注入-html-中" class="router-link-active router-link-exact-active sidebar-item" aria-label="将资源注入 html 中"><!--[--><!--]--> 将资源注入 html 中 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#创建本地服务" class="router-link-active router-link-exact-active sidebar-item" aria-label="创建本地服务"><!--[--><!--]--> 创建本地服务 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#重新组织-gulpfile" class="router-link-active router-link-exact-active sidebar-item" aria-label="重新组织 gulpfile"><!--[--><!--]--> 重新组织 gulpfile <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/front/webpack/2022-07-03.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/front/webpack/2022-07-05.html" class="sidebar-item" aria-label="介绍几个不太常用的打包分析工具"><!--[--><!--]--> 介绍几个不太常用的打包分析工具 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-07-06.html" class="sidebar-item" aria-label="Module Federation最佳实践"><!--[--><!--]--> Module Federation最佳实践 <!--[--><!--]--></a><!----></li><li><a href="/front/webpack/2022-07-10.html" class="sidebar-item" aria-label="写一个自定义loader，看完，就会"><!--[--><!--]--> 写一个自定义loader，看完，就会 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><p>别被标题吓到，哈哈，即使现在<code>vite</code>横空出世，社区光芒四射，两个字很快，但是<code>webpack</code>依旧宝刀未老，依然扛起前端工程化的大梁，但是今天我为啥说要拥抱<code>gulp</code>，因为我们经常常吃一道菜，所以要换个口味，这样才营养均衡。</p><p><code>gulp</code>定义是：用<code>自动化构建工具</code>增强你的<code>工作流程</code>,是一种基于任务<code>文件流</code>方式,你可以在前端写一些自动化脚本，或者升级历史传统项目，解放你重复打包，压缩，解压之类的操作。</p><p>个人理解<code>gulp</code>是一种<code>命令式编程</code>的体验，更注重构建过程，所有的任务需要你自己手动创建，你会对构建流程会非常清楚，这点不像<code>webpack</code>，<code>webpack</code>就是一个开箱即用的<code>声明式</code>方式,<code>webpack</code>是一个模块化打包工具，内部细节隐藏非常之深，你也不需关注细节，你只需要照着提供的<code>API</code>以及引入对应的<code>loader</code>和<code>plugin</code>使用就行。</p><p>言归正传，为了<code>饮食均衡</code>，今天一起学习下<code>gulpjs</code></p><p>正文开始...</p><h3 id="搭建一个简单的前端应用" tabindex="-1"><a class="header-anchor" href="#搭建一个简单的前端应用" aria-hidden="true">#</a> 搭建一个简单的前端应用</h3><p>相比较<code>webpack</code>，其实<code>gulp</code>的项目结构更偏向传统的应用，只是我们借助<code>gulp</code>工具解放我们的一些<code>代码压缩</code>、<code>es6编译</code>、<code>打包</code>以及在传统项目中都可以使用<code>less</code>体验。</p><p>在<code>gulp</code>目录下新建<code>01-simple-demo</code></p><p>根目录下生成默认<code>package.json</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm init <span class="token operator">-</span>y
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后在<code>public</code>目录下新建<code>images</code>、<code>css</code>、<code>js</code>、<code>index.html</code></p><p>文件结构，大概就这样 <img src="https://files.mdnice.com/user/24614/9bd5fcfa-6030-4709-a33a-08c09400dd1d.png" alt=""></p><p>然后在安装<code>gulp</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm i gulp <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在根目录下新建<code>gulpfile.js</code> 我们先在<code>gulpfile.js</code>中写入一点内容，测试一下</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">defaultTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>default <span class="token operator">=</span> defaultTask<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后我们在命令行执行</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npx gulp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://files.mdnice.com/user/24614/6a5b09c0-2a44-4f77-8868-83c34281061a.png" alt=""></p><p>当我们执行<code>npx gulp</code>时会默认运行<code>gulpfile.js</code>导出的<code>default</code>,在<code>gulpfile.js</code>导出的任务会注册到<code>gulp</code>任务中</p><p>在<code>gulp</code>中任务主要分两种，一种是<code>公开任务</code>、另一种是<code>私有任务</code></p><p><code>公开任务</code>可以直接在命令执行<code>npx gulp xxx</code>调用执行，比如下面的<code>defaultTask</code>就是一个公开任务，只要被导出就是一个公开任务,没有被导出就是一个私有任务。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
exports<span class="token punctuation">.</span>default <span class="token operator">=</span> defaultTask<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>公有任务<code>taskJS</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// gulpfile.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathDir</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// todo 执行ts任务，将js目录下的js打包到dist/js目录下</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskJS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/**/*.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">sourcemaps</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>taskJS <span class="token operator">=</span> taskJS<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后你在命令行执行</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npx gulp taskJS
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://files.mdnice.com/user/24614/3efda27e-ffa8-4a1e-a2dd-8f8385000df6.png" alt=""><img src="https://files.mdnice.com/user/24614/83520e02-0a89-4ec4-86e3-2ba04bf4fc4f.png" alt=""> 至此你会发现<code>dist</code>目录下就有生成的<code>js</code>了</p><h3 id="安装-less" tabindex="-1"><a class="header-anchor" href="#安装-less" aria-hidden="true">#</a> 安装 less</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm i less gulp<span class="token operator">-</span>less <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在<code>css/index.less</code>中写入测试 css 的代码</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@bgcolor</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span></span>
<span class="token atrule"><span class="token rule">@defaultsize</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span></span>
<span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@bgcolor</span><span class="token punctuation">;</span></span>
<span class="token punctuation">}</span>
<span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@defaultsize</span><span class="token punctuation">;</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>gulpfile.js</code>中写入编译<code>less</code>的任务，需要<code>gulp-less</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> less <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-less&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathDir</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token comment">// todo less任务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskLess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// css目录洗的所有.less文件，dest输出到dist/css目录下</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/css/*.less&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">less</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
exports<span class="token punctuation">.</span>taskLess <span class="token operator">=</span> taskLess<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>命令行运行<code>npx gulp taskLess</code>，结果如下 <img src="https://files.mdnice.com/user/24614/8d511316-2996-4f2b-807a-bbf664f7433e.png" alt=""></p><h3 id="图片资源" tabindex="-1"><a class="header-anchor" href="#图片资源" aria-hidden="true">#</a> 图片资源</h3><p>使用一个<code>gulp-image</code>插件对图片进行无损压缩处理</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// gulpfile.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-image&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathDir</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token comment">// todo 图片资源</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskImage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/images/*.*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/images&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
exports<span class="token punctuation">.</span>taskImage <span class="token operator">=</span> taskImage<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://files.mdnice.com/user/24614/0386247b-f3d8-4f80-96bb-8ec5cfc20e1d.png" alt=""></p><p>一顿操作发现，最新版本不支持<code>esm</code>,所以还是降低版本版本，这里降低到<code>6.2.1</code>版本</p><p>然后运行<code>npx gulp taskImage</code><img src="https://files.mdnice.com/user/24614/f8931764-69ae-41f5-9d26-d91656957f12.png" alt=""> 图片压缩得不小</p><p>在这之前，我们分别定义了三个不同的任务，<code>gulp</code>导出的任务有 公开任务和私有任务，多个公开任务可以<code>串行组合</code>使用</p><h3 id="组合任务-series-与-parallel" tabindex="-1"><a class="header-anchor" href="#组合任务-series-与-parallel" aria-hidden="true">#</a> 组合任务 series 与 parallel</h3><p>因此我可以将之前的介个任务组合在一起</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// gulpfile.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest<span class="token punctuation">,</span> series <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> less <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-less&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-image&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathDir</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// todo js任务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskJS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/**/*.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">sourcemaps</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token comment">// series组合多个任务</span>
<span class="token keyword">const</span> seriseTask <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>taskJS<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskImage<span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>seriseTask <span class="token operator">=</span> seriseTask<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当我在命令行<code>npx gulp seriseTask</code>时 <img src="https://files.mdnice.com/user/24614/646e2620-66d2-48af-865e-9989a568bbeb.png" alt=""> 已经在<code>dist</code>生成对应的文件了</p><h3 id="编译转换-es6" tabindex="-1"><a class="header-anchor" href="#编译转换-es6" aria-hidden="true">#</a> 编译转换 es6</h3><p>在我们<code>index.js</code>，很多时候是写的<code>es6</code>，在<code>gulp</code>中我们需要一些借助一些插件<code>gulp-babel</code>,另外我们需要安装另外两个<code>babel</code>核心插件<code>@babel/core</code>,<code>@babel/preset-env</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code> npm i gulp<span class="token operator">-</span>babel @babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在<code>gulpfile.js</code>中我们需要修改下</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-babel&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// todo js任务</span>
<span class="token comment">// 用babel转换es6语法糖</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskJS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/**/*.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">sourcemaps</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当我们在<code>js/index.js</code>写入一段测试代码</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>js <span class="token operator">/</span> index<span class="token punctuation">.</span>js<span class="token punctuation">;</span>
<span class="token keyword">const</span> appDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
appDom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;hello gulp&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;公众号：Web技术学苑，好好学习，天天向上&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行<code>npx gulp seriseTask</code><img src="https://files.mdnice.com/user/24614/6c69c15e-5e5b-45ff-99cf-dd91df5652de.png" alt=""> 箭头函数和<code>const</code>申明的变量就变成了<code>es5</code>了</p><p>通常情况下，一般打包后的<code>dist</code>下的<code>css</code>或者<code>js</code>都会被压缩,在<code>gulp</code>中也是需要借助插件来完成</p><h3 id="压缩-js-与-css" tabindex="-1"><a class="header-anchor" href="#压缩-js-与-css" aria-hidden="true">#</a> 压缩 js 与 css</h3><p>压缩<code>js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> teser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-terser&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// todo js任务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskJS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/**/*.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">sourcemaps</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">teser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">mangle</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">toplevel</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 混淆代码</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>压缩<code>css</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> uglifycss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-uglifycss&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// todo less任务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskLess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/css/*.less&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">less</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">uglifycss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist/css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这之前我们在输出<code>dest</code>时候我们都执向了一个具体的文件目录，在<code>src</code>这个<code>api</code>中是创建流，从文件中读取<code>vunyl</code>对象，本身也提供了一个<code>base</code>属性，因此你可以像下面这样写</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest<span class="token punctuation">,</span> series <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> less <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-less&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-image&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-babel&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> teser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-terser&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uglifycss <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-uglifycss&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathDir</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 设置base，当输出文件目标dist文件时，会自动拷贝当前文件夹到目标目录</span>
<span class="token keyword">const</span> basePath <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&#39;./public&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// todo js任务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskJS</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/**/*.js&#39;</span><span class="token punctuation">,</span> basePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
      <span class="token function">teser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">mangle</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">toplevel</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 混淆代码</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// todo less任务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskLess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/css/*.less&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> basePath<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">less</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">uglifycss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// todo 图片资源，有压缩，并输出到对应的dist/images文件夹下</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskImage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/images/*.*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> basePath<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// todo html</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskHtml</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public/index.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> basePath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">defaultTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// series组合多个任务</span>
<span class="token keyword">const</span> seriseTask <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>taskHtml<span class="token punctuation">,</span> taskJS<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskImage<span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>default <span class="token operator">=</span> defaultTask<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>taskJS <span class="token operator">=</span> taskJS<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>taskLess <span class="token operator">=</span> taskLess<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>taskImage <span class="token operator">=</span> taskImage<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>seriseTask <span class="token operator">=</span> seriseTask<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="将资源注入-html-中" tabindex="-1"><a class="header-anchor" href="#将资源注入-html-中" aria-hidden="true">#</a> 将资源注入 html 中</h3><p>在<code>gulp</code>中，任务之间的依赖关系需要我们自己手动写一些执行任务流，现在一些打包后的<code>dist</code>的文件并不会自动注入<code>html</code>中。</p><p>参考<a href="https://www.npmjs.com/package/gulp-inject" title="gulp-inject" target="_blank" rel="noopener noreferrer">gulp-inject<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>
<span class="token keyword">const</span> inject <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-inject&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token comment">// 将css,js插入html中</span>
<span class="token keyword">const</span> <span class="token function-variable function">injectHtml</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 目标资源</span>
  <span class="token keyword">const</span> targetSources <span class="token operator">=</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./dist/**/*.js&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;./dist/**/*.css&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">read</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 目标html</span>
  <span class="token keyword">const</span> targetHtml <span class="token operator">=</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">&#39;./dist/*.html&#39;</span><span class="token punctuation">)</span>
  <span class="token comment">// 把目标资源插入目标html中，同时输出到dist文件下</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> targetHtml<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">inject</span><span class="token punctuation">(</span>targetSources<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token comment">// series串行组合多个任务</span>
<span class="token keyword">const</span> seriseTask <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>taskHtml<span class="token punctuation">,</span> taskJS<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskImage<span class="token punctuation">,</span> injectHtml<span class="token punctuation">)</span>

exports<span class="token punctuation">.</span>seriseTask <span class="token operator">=</span> seriseTask<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意一个执行顺序，必须是等前面任务执行完了，再注入，所以在<code>series</code>任务的最后才执行<code>injectHtml</code>操作</p><p>并且在<code>public/index.html</code>下，还需要加入一段注释</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>gulp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- inject:css --&gt;</span>
    <span class="token comment">&lt;!-- endinject --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- inject:js --&gt;</span>
    <span class="token comment">&lt;!-- endinject --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当我们运行<code>npx gulp seriseTask</code>时 <img src="https://files.mdnice.com/user/24614/3068ad7b-eeeb-4323-9128-74a3cd4edb11.png" alt=""></p><h3 id="创建本地服务" tabindex="-1"><a class="header-anchor" href="#创建本地服务" aria-hidden="true">#</a> 创建本地服务</h3><p>参考<a href="https://browsersync.io/docs/gulp" title="browser-sync" target="_blank" rel="noopener noreferrer">browser-sync<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest<span class="token punctuation">,</span> series<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> browserSync <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;browser-sync&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>

<span class="token keyword">const</span> taskBuild <span class="token operator">=</span> seriseTask<span class="token punctuation">;</span>
<span class="token comment">// 本地服务</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskDevServer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 监听public所有目录下，只要文件发生改变，就重新加载</span>
  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> taskBuild<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 创建服务</span>
  <span class="token keyword">const</span> server <span class="token operator">=</span> browserSync<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 调用init开启端口访问</span>
  server<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token string">&#39;8081&#39;</span><span class="token punctuation">,</span> <span class="token comment">//设置端口</span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 自动打开浏览器</span>
    <span class="token literal-property property">files</span><span class="token operator">:</span> <span class="token string">&#39;./dist/*&#39;</span><span class="token punctuation">,</span> <span class="token comment">// dist文件</span>
    <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">baseDir</span><span class="token operator">:</span> <span class="token string">&#39;./dist&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
exports<span class="token punctuation">.</span>taskDevServer <span class="token operator">=</span> taskDevServer<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当我们运行<code>npx gulp taskDevServer</code>时，浏览器会默认打开<code>http://localhost:8081</code></p><p><img src="https://files.mdnice.com/user/24614/12d77b8b-379b-4922-9d72-05029484cbe3.png" alt=""></p><p>我们使用了一个<code>watch</code>监听<code>public</code>目录下的所有文件，如果文件有变化时，会执行<code>taskBuild</code>任务会在<code>dist</code>目录下生成对应的文件，然后会启动一个本地服务，打开一个<code>8081</code>的端口就可以访问应用了。</p><p>至此一个一个用<code>gulp</code>搭建的前端应用终于可以了。</p><h3 id="重新组织-gulpfile" tabindex="-1"><a class="header-anchor" href="#重新组织-gulpfile" aria-hidden="true">#</a> 重新组织 gulpfile</h3><p>最后我们可以再重新组织一下<code>gulpfile.js</code>，因为多个任务写在一个文件里貌似不太那么好维护，随着业务迭代，会越来越多，因此，有必要将任务分解一下</p><p>在根目录新建<code>task</code>，我们把所有的任务如下</p><p><code>common.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// task/common.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathDir</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;../&#39;</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> rootDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;../&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> basePath <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&#39;./public&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> targetDest <span class="token operator">=</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  rootDir<span class="token punctuation">,</span>
  pathDir<span class="token punctuation">,</span>
  basePath<span class="token punctuation">,</span>
  targetDest
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>injectHtml.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// task/injectHtml.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> inject <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp-inject&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> targetDest<span class="token punctuation">,</span> rootDir <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./common.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将css,js插入html中</span>
<span class="token keyword">const</span> <span class="token function-variable function">injectHtml</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 目标资源</span>
  <span class="token keyword">const</span> targetSources <span class="token operator">=</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>targetDest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>targetDest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*.css</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 目标html</span>
  <span class="token keyword">const</span> targetHtml <span class="token operator">=</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>targetDest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/*.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 把目标资源插入目标html中，同时输出到dist文件下</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> targetHtml<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">inject</span><span class="token punctuation">(</span>targetSources<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">relative</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>targetDest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> injectHtml<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>taskDevServer.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> watch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> browserSync <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;browser-sync&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> pathDir<span class="token punctuation">,</span> targetDest<span class="token punctuation">,</span> rootDir <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./common.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">taskDevServer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">taskBuild</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> defaultOption <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token string">&#39;8081&#39;</span><span class="token punctuation">,</span> <span class="token comment">//设置端口</span>
      <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 自动打开浏览器</span>
      <span class="token literal-property property">files</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>targetDest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// 当dist文件下有改动时，会自动刷新页面</span>
      <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">baseDir</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>targetDest<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token comment">// 基于当前dist目录</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>options
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 监听public所有目录下，只要文件发生改变，就重新加载</span>
    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token function">pathDir</span><span class="token punctuation">(</span><span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> taskBuild<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> server <span class="token operator">=</span> browserSync<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>defaultOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> taskDevServer<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>...</p><p><code>task/index.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> injectHtml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./injectHtml.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> taskDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./taskDevServer.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> taskHtml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./taskHtml.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> taskImage <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./taskImage.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> taskJS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./taskJS.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> taskLess <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./taskLess.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  injectHtml<span class="token punctuation">,</span>
  taskDevServer<span class="token punctuation">,</span>
  taskHtml<span class="token punctuation">,</span>
  taskImage<span class="token punctuation">,</span>
  taskJS<span class="token punctuation">,</span>
  taskLess
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>gulpfile.js</code>中，我们修改下</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// gulpfile.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> series <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> injectHtml<span class="token punctuation">,</span> taskDevServer<span class="token punctuation">,</span> taskHtml<span class="token punctuation">,</span> taskImage<span class="token punctuation">,</span> taskJS<span class="token punctuation">,</span> taskLess <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./task/index.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// series组合多个任务</span>
<span class="token keyword">const</span> seriseTask <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>taskHtml<span class="token punctuation">,</span> taskJS<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskLess<span class="token punctuation">,</span> taskImage<span class="token punctuation">,</span> injectHtml<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 本地服务</span>
<span class="token keyword">const</span> devServer <span class="token operator">=</span> <span class="token function">taskDevServer</span><span class="token punctuation">(</span>seriseTask<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 启动服务</span>
<span class="token keyword">const</span> <span class="token function-variable function">server</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">devServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">9000</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> taskBuild <span class="token operator">=</span> seriseTask<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">defaultTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello gulp&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>default <span class="token operator">=</span> defaultTask<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>server <span class="token operator">=</span> server<span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>build <span class="token operator">=</span> taskBuild<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们在<code>package.json</code>中新增命令</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gulp server&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gulp build&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>npm run build</code><img src="https://files.mdnice.com/user/24614/6a153691-c44a-4c10-babd-3db13e18e3e1.png" alt=""></p><p>在启动<code>server</code>之前，我们先执行<code>npm run build</code>，然后再执行下面命令,保证<code>browserSync</code>创建的服务文件夹存在，不然页面打开就<code>404</code>错误</p><p><code>npm run server</code><img src="https://files.mdnice.com/user/24614/6ad27744-68ad-44c6-b5fb-aac0fd3cc5f0.png" alt=""></p><p>至此<code>gulp</code>搭建一个简单的应该就已经完全 ok 了 <img src="https://files.mdnice.com/user/24614/1ecf7254-507b-4956-9282-07de62271e7a.png" alt=""></p><p>页面背景貌似有点黄 <img src="https://img.soogif.com/2Y2r9Qj6ydfIQFGKMWJNE2lUUGwzfymA.gif?scope=mdnice" alt=""></p><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h3><ul><li><p><code>gulpjs</code>开发是一个任务流的开发方式，它的核心思想就是<code>用自动化构建工具增强你的工作流</code>,所有的自动化工作流操作都牢牢的掌握在自己手上，你可以用<code>gulp</code>写一些自动化脚本，比如，文件上传，打包，压缩，或者改造传统的前端应用。</p></li><li><p>用<code>gulp</code>写了一个简单的应用，但是发现中途需要找好多<code>gulp</code>插件，<code>gulp</code>的生态还算可以，<code>3w</code>多个 star，生态相对丰富，但是有些插件常年不更新，或者版本更新不支持，比如<code>gulp-image</code>，当你按照官方文档使用最新的包时，不支持 esm，你必须降低版本<code>6.2.1</code>,改用<code>cjs</code>才行</p></li><li><p>使用<code>gulp</code>的一些常用的 api,比如<code>src</code>、<code>dest</code>、<code>series</code>,以及<code>browser-sync</code>实现本地服务，更多<a href="https://www.gulpjs.com.cn/docs/api/src/" title="api" target="_blank" rel="noopener noreferrer">api<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>参考官方文档。</p></li><li><p>即使项目时间再多，也不要用<code>gulp</code>搭建前端应用，因为<code>webpack</code>生态很强大了，看<code>gulp</code>的最近更新还是 2 年前，但是写个自动化脚本，还算可以，毕竟<code>gulp</code>的理念就是<code>用自动化构建工具增强你工作流程</code>，也许当你接盘传统项目时，一些打包，拷贝，压缩文件之类的，可以尝试用用这个。</p></li><li><p>本文示例<a href="https://github.com/maicFir/lessonNote/tree/master/gulp/01-simple-demo" title="code-example" target="_blank" rel="noopener noreferrer">code-example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/maicFir/maicFir.github.io/edit/dev2.0/front/webpack/2022-07-03.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--> Edit this page on GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">作者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: anne.duan@aax.com">maicFir</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/front/webpack/2022-06-29.html" class="" aria-label="webpack5构建一个通用的组件库"><!--[--><!--]--> webpack5构建一个通用的组件库 <!--[--><!--]--></a></span><span class="next"><a href="/front/webpack/2022-07-05.html" class="" aria-label="介绍几个不太常用的打包分析工具"><!--[--><!--]--> 介绍几个不太常用的打包分析工具 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.d833009d.js" defer></script>
  </body>
</html>
